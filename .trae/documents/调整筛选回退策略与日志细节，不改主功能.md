## 问题复盘
- 日志显示：百度检索成功拿到 9 条，但筛选阶段通过 0、驳回 9 → 抓取 0 → 最终代表材料 0。
- 原因：筛选规则过于严格（标题需包含查询词），查询如“banana2”不一定出现在标题里；导致全被驳回，后续抓取为空，看起来像“直接总结”。
- 主功能“百度检索 → 豆包生成”正常，问题在“筛选与流程展示”的策略与细节。

## 目标
- 在不改变主功能的前提下，调整筛选的回退策略：当严格命中为 0 时，保留若干高置信参考作为候选，避免空材料。
- 增强日志细节：展示被驳回的示例与原因，让流程更可观。

## 计划改动（仅流程与日志，不改主功能）
1. 筛选回退策略
- 当严格命中为 0 时，启用回退：
  - 从百度 references 中按基础质量评分（去掉黑名单域、URL长度合理、含关键词的片段优先）保留前 5 条；
  - 发出事件：`filter_fallback`（reason: no_keyword_hit, kept: N）。
- 仍保留原黑名单域过滤（`baidu.com/image.baidu.com/v.baidu.com`）。

2. 日志细化
- 在筛选阶段：
  - 增加 `filter_reject_samples`（列出前 3 条被驳回标题+域+原因）。
  - 保留现有 `filter/detail/rejects` 数量事件。
- 在抓取阶段：
  - 逐条事件 `fetch_item_ok/fetch_item_fail` 保留；
  - 对回退保留的 N 条进行抓取，避免 0。

3. 解析一致性
- 继续以 AppBuilder Web Search 的 `references` 作为材料来源；不再依赖 `choices/message`。
- 摘要交由豆包生成，不改主逻辑。

4. Pages 与本地一致性
- 确认 `/api/fetch` 路径替换在发布构建后依然正确（`/api/chat` → `/api/fetch`）；如 `apiUrl` 无尾缀斜杠也能正常替换。
- 若 materials 仍为 0，页面会显示 `filter_fallback` 与 `filter_reject_samples`，便于定位。

## 验证
- 用一个难命中的主题（如 banana2）：应看到 fallback 生效，抓取成功≥1，最终代表材料≥1。
- 用常见主题（如 gemini 3）：严格命中正常通过，抓取>0。

## 交付
- 仅修改前端筛选策略与日志事件，Worker 与主功能保持不变。
- 推送后 GitHub Pages 自动更新，线上效果与本地一致。