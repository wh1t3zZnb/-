## 项目结构综述
- 前端入口与日志：`frontend/src/App.jsx:39-116`（事件消费与打印），阶段变量定义在 `frontend/src/App.jsx:59`。
- 编排流程：`frontend/src/lib/orchestrator.js:3-70`（百度检索→筛选→抓取→LLM），事件包含 `baidu_search_*`、`filter`、`fetch`、`final`，并有 `phase_change`、`filter_rejects/detail`、`fetch_item_ok/fail`。
- 百度解析：`frontend/src/lib/baidu.js:6-19` 构造 Web Search 请求；`frontend/src/lib/baidu.js:23-46` 解析 `data.references`。
- Worker 路由：`workers/worker.js:17-90` `/api/chat` 路由百度与豆包；`workers/worker.js:92-110` `/api/fetch` 抓正文；`workers/worker.js:111-114` 404带CORS。

## 当前行为与原因（按代码）
- 严格筛选导致通过=0：`frontend/src/lib/orchestrator.js:24-31`（标题需包含查询词，且屏蔽黑名单域名），查询词不在标题时全部驳回，后续抓取为空。
- 阶段未推进显示：`frontend/src/App.jsx:59` 的 `phase` 未在 `switch` 中更新，日志左侧阶段始终是 `init`，易被误解为“直接总结”。
- 解析一致：百度材料来自 `references`（`frontend/src/lib/baidu.js:23-46`），摘要由豆包生成，不跳过管线。

## 本地与 Pages 差异来源
- 输入查询不同导致筛选结果不同：本地关键词更易命中标题（通过>0）；线上关键词不在标题（通过=0）。逻辑一致，数据不同。

## 改动边界（不改核心功能）
- 不改“百度检索→豆包生成”的主路径；不改 Worker 路由与上游；不改安全边界（Secrets只在Worker）。
- 仅增强“过程展示与可观测”，让日志完整反映检索→筛选→抓取→总结。

## 具体改动（仅前端）
1) 完整消费事件（添加日志）：
- 在 `frontend/src/App.jsx:62-108` 的 `switch(ev.type)` 中补充：
  - `phase_change`：更新 `phase` 并打印 `阶段：old → new`。
  - `filter_rejects` 与 `filter_detail`：打印被驳回数量、通过/驳回统计。
  - `fetch_item_ok` 与 `fetch_item_fail`：逐条打印抓取成功/失败及标题。
2) 解析保持不变：
- 保持 `frontend/src/lib/baidu.js:23-46` 以 `data.references` 解析材料，摘要仍由豆包生成。

## 验证方案
- 用“容易命中”的主题（如含常见词）与“难命中”的主题（如不在标题）各跑一条：
  - 期望日志按序显示：`baidu_search_start/ok` → `phase_change: init→filter` + `filter/detail/rejects` → `phase_change: filter→fetch` + `fetch_item_ok/fail` → `phase_change: fetch→llm` → `final`。
  - 材料=0时仍直出豆包，但日志清楚呈现“为何为空”。

## 风险与回滚
- 仅打印日志事件，不影响主流程；如不满意，可直接回滚 App.jsx 的事件消费改动。

## 交付
- 提交前端事件消费的增量改动（仅日志可视化），不触碰 Worker 与主业务逻辑；同步 GitHub Pages 后线上、本地表现一致。请确认后我开始实施。